---
import { getCollection } from 'astro:content'

import '@/styles/global.css'

import { SITE } from '@/config'
import BaseHead from '@/components/BaseHead.astro'
import Footer from '@/components/Footer.astro'
import Header from '@/components/Header.astro'
import Subscribe from '@/components/Subscribe.astro'
import Menu from '@/components/Menu.astro'
import Contact from '@/components/Contact.astro'
import Prose from '@/components/Prose.astro'
import ModalMenu from '@/components/Modal/Menu/index.svelte'
import ModalMenuMenu from '@/components/Modal/Menu/Menu.astro'
import LayoutGrid from '@/components/LayoutGrid.astro'

export async function getStaticPaths() {
  const pageEntries = await getCollection('pages')
  return pageEntries.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }))
}

const { entry } = Astro.props
const { Content } = await entry.render()
---

<html lang={SITE.lang}>
  <BaseHead {...entry.data} title={`${entry.data.name} - ${SITE.name}`} />
  <body class:list={[entry.data.theme == 'white' && 'bg-qux text-white']}>
    <div class="flex flex-col w-full min-h-screen">
      <Header />
      <main class="flex-auto">
        <article class="flex-auto overflow-x-hidden" id={entry.data.slug}>
          <div class="container">
            <div class="relative grid lg:gap-10 lg:grid-cols-8">
              <div class="lg:col-span-2"></div>
              <div class="lg:col-span-6">
                <h1 class="h1 mb-10">{entry.data.name}</h1>
                <Prose
                  class={entry.data.theme == 'white'
                    ? 'prose-white'
                    : 'prose-black'}
                >
                  <Content />
                </Prose>
              </div>
            </div>
          </div>
        </article>
      </main>
      <Contact />
      <Subscribe />
      <Menu />
      <Footer />
    </div>
    <ModalMenu client:load>
      <ModalMenuMenu />
    </ModalMenu>
    <LayoutGrid />
  </body>
</html>
