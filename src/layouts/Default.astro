---
import { getEntryBySlug } from 'astro:content';
// import { Schema } from 'astro-seo-schema'

import '@/styles/global.css';

import BaseHead from '@/components/BaseHead.astro';
import Header from '@/components/Header.astro';
import Subscribe from '@/components/Subscribe.astro';
import Contact from '@/components/Contact.astro';
import NavSecondary from '@/components/Nav/Secondary.astro';
import Footer from '@/components/Footer.astro';
import DialogMenu from '@/components/Dialog/Menu.astro';
import DialogContact from '@/components/Dialog/Contact.astro';
// import LayoutGrid from '@/components/LayoutGrid.astro'

export interface Props {
  title: string;
  description?: string;
  url?: string;
  image?: {
    url?: string;
    width?: number;
    height?: number;
    alt?: string;
  };
  noindex?: boolean;
  class?: string;
  scope?: string;
}

const navSecondary = await getEntryBySlug('menu', 'secondary');

const {
  title,
  description,
  url,
  image,
  noindex = false,
  class: className,
  scope,
} = Astro.props as Props;

const meta = { title, description, url, image, noindex };

const contact = {
  name: 'Let’s talk',
  description: 'Tell us where you want to be. We’ll make sure you get there.',
};
---

<!DOCTYPE html>
<html lang="en" dir="ltr">
  <BaseHead {...meta}>
    <slot name="head" />
  </BaseHead>
  <body class:list={[className, 'dark:bg-qux dark:text-white', scope]}>
    <div class="flex min-h-screen w-full flex-col">
      <Header />
      <main class="flex-auto">
        <slot />
      </main>
      <Contact {...contact} />
      <Subscribe />
      {navSecondary && <NavSecondary nav={navSecondary} />}
      <Footer />
    </div>
    <DialogMenu />
    <DialogContact />
    <script src="https://substackapi.com/widget.js" async></script>
    <script is:inline>
      const dialogMenu = document.querySelector('#dialog-menu');
      const openDialogMenu = document.querySelector('.open-dialog-menu');
      openDialogMenu.addEventListener('click', () => {
        dialogMenu.showModal();
      });

      const dialogContact = document.querySelector('#dialog-contact');

      const openDialogContact = document.querySelector('.open-dialog-contact');
      openDialogContact.addEventListener('click', () => {
        dialogContact.showModal();
      });

      window.CustomSubstackWidget = {
        substackUrl: 'insights.futurestatedesign.co',
        placeholder: 'Type your email...',
        buttonText: 'Subscribe',
        theme: 'custom',
        colors: {
          primary: '#11c338',
          input: '#F7F7F70',
          email: '#000',
          text: '#fff',
        },
      };
    </script>
  </body>
</html>
